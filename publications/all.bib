@inproceedings{vlastelica2020differentiation,
  title        = {Differentiation of Blackbox Combinatorial Solvers},
  author       = {Anselm Paulus* and
                  Marin Vlastelica P.* and
                  Vít Musil and
                  Georg Martius and
                  Michal Rolínek},
  year         = {2020},
  codeurl      = {https://github.com/martius-lab/blackbox-backprop},
  url          = {http://arxiv.org/abs/1912.02175},
  _venue       = {ICLR},
  selected     = {true},
  _note        = {Spotlight},
  abstract     = {
    Achieving fusion of deep learning with combinatorial algorithms promises transformative changes to artificial intelligence. One possible approach is to introduce combinatorial building blocks into neural networks. Such end-to-end architectures have the potential to tackle combinatorial problems on raw input data such as ensuring global consistency in multi-object tracking or route planning on maps in robotics. In this work, we present a method that implements an efficient backward pass through blackbox implementations of combinatorial solvers with linear objective functions. We provide both theoretical and experimental backing. In particular, we incorporate the Gurobi MIP solver, Blossom V algorithm, and Dijkstra's algorithm into architectures that extract suitable features from raw inputs for the traveling salesman problem, the min-cost perfect matching problem and the shortest path problem.
  }
}

@inproceedings{rolinek2020optimizing,
  title        = {Optimizing Rank-based Metrics with Blackbox Differentiation},
  author       = {Michal Rolínek* and
                  Vít Musil* and
                  Anselm Paulus and
                  Marin Vlastelica P. and
                  Claudio Michaelis and
                  Georg Martius},
  year         = {2020},
  codeurl      = {https://github.com/martius-lab/blackbox-backprop},
  url          = {http://arxiv.org/abs/1912.03500},
  _venue       = {CVPR},
  selected     = {false},
  _note        = {Oral, best paper award nomination},
  abstract     = {
    Rank-based metrics are some of the most widely used criteria for performance evaluation of computer vision models. Despite years of effort, direct optimization for these metrics remains a challenge due to their non-differentiable and non-decomposable nature. We present an efficient, theoretically sound, and general method for differentiating rank-based metrics with mini-batch gradient descent. In addition, we address optimization instability and sparsity of the supervision signal that both arise from using rank-based metrics as optimization targets. Resulting losses based on recall and Average Precision are applied to image retrieval and object detection tasks. We obtain performance that is competitive with state-of-the-art on standard image retrieval datasets and consistently improve performance of near state-of-the-art object detectors.
  }
}

@inproceedings{rolinek2020deepgraphmatching,
  title        = {Deep Graph Matching via Blackbox Differentiation of Combinatorial Solvers},
  author       = {Michal Rolínek and
                  Paul Swoboda and
                  Dominik Zietlow and
                  Anselm Paulus and
                  Vít Musil and
                  Georg Martius},
  year         = {2020},
  codeurl      = {https://github.com/martius-lab/blackbox-deep-graph-matching},
  url          = {https://arxiv.org/abs/2003.11657},
  _venue       = {ECCV},
  selected     = {false},
  abstract     = {
    Building on recent progress at the intersection of combinatorial optimization and deep learning, we propose an end-to-end trainable architecture for deep graph matching that contains unmodified combinatorial solvers. Using the presence of heavily optimized combinatorial solvers together with some improvements in architecture design, we advance state-of-the-art on deep graph matching benchmarks for keypoint correspondence. In addition, we highlight the conceptual advantages of incorporating solvers into deep learning architectures, such as the possibility of post-processing with a strong multi-graph matching solver or the indifference to changes in the training setting. Finally, we propose two new challenging experimental setups.
  }
}

@inproceedings{paulus2021comboptnet,
  title        = {CombOptNet: Fit the Right NP-Hard Problem by Learning Integer Programming Constraints},
  author       = {Anselm Paulus and
                  Michal Rolínek and
                  Vít Musil and
                  Brandon Amos and
                  Georg Martius},
  year         = {2021},
  codeurl      = {https://github.com/martius-lab/CombOptNet},
  url          = {https://arxiv.org/pdf/2105.02343},
  _venue       = {ICML},
  selected     = {false},
  _note        = {Spotlight, Oral at LMCA NeurIPS 2020 workshop},
  abstract     = {
    Bridging logical and algorithmic reasoning with modern machine learning techniques is a fundamental challenge with potentially transformative impact. On the algorithmic side, many NP-hard problems can be expressed as integer programs, in which the constraints play the role of their "combinatorial specification." In this work, we aim to integrate integer programming solvers into neural network architectures as layers capable of learning both the cost terms and the constraints. The resulting end-to-end trainable architectures jointly extract features from raw data and solve a suitable (learned) combinatorial problem with state-of-the-art integer programming solvers. We demonstrate the potential of such layers with an extensive performance analysis on synthetic data and with a demonstration on a competitive computer vision keypoint matching benchmark.
  }
}

@inproceedings{sahoo2024gradient,
  title        = {Backpropagation through Combinatorial Algorithms: Identity with Projection Works},
  author       = {Anselm Paulus* and
                  Subham Sekhar Sahoo* and
                  Marin Vlastelica and
                  Vít Musil and
                  Volodymyr Kuleshov and
                  Georg Martius},
  year         = {2023},
  codeurl      = {https://github.com/martius-lab/solver-differentiation-identity},
  url          = {https://arxiv.org/abs/2205.15213},
  _venue       = {ICLR},
  selected     = {false},
  abstract     = {
    Embedding discrete solvers as differentiable layers has given modern deep learning architectures combinatorial expressivity and discrete reasoning capabilities. The derivative of these solvers is zero or undefined, therefore a meaningful replacement is crucial for effective gradient-based learning. Prior works rely on smoothing the solver with input perturbations, relaxing the solver to continuous problems, or interpolating the loss landscape with techniques that typically require additional solver calls, introduce extra hyper-parameters, or compromise performance. We propose a principled approach to exploit the geometry of the discrete solution space to treat the solver as a negative identity on the backward pass and further provide a theoretical justification. Our experiments demonstrate that such a straightforward hyper-parameter-free approach is able to compete with previous more complex methods on numerous experiments such as backpropagation through discrete samplers, deep graph matching, and image retrieval. Furthermore, we substitute the previously proposed problem-specific and label-dependent margin with a generic regularization procedure that prevents cost collapse and increases robustness.
  }
}

@inproceedings{paulus2024lpgd,
  title        = {{LPGD:} {A} General Framework for Backpropagation through Embedded
                  Optimization Layers},
  author       = {Anselm Paulus and
                  Georg Martius and
                  Vít Musil},
  year         = {2024},
  codeurl      = {https://github.com/martius-lab/diffcp-lpgd},
  url          = {https://arxiv.org/abs/2407.05920},
  _venue       = {ICML},
  selected     = {true},
  abstract     = {
    Embedding parameterized optimization problems as layers into machine learning architectures serves as a powerful inductive bias. Training such architectures with stochastic gradient descent requires care, as degenerate derivatives of the embedded optimization problem often render the gradients uninformative. We propose Lagrangian Proximal Gradient Descent (LPGD) a flexible framework for training architectures with embedded optimization layers that seamlessly integrates into automatic differentiation libraries. LPGD efficiently computes meaningful replacements of the degenerate optimization layer derivatives by re-running the forward solver oracle on a perturbed input. LPGD captures various previously proposed methods as special cases, while fostering deep links to traditional optimization methods. We theoretically analyze our method and demonstrate on historical and synthetic data that LPGD converges faster than gradient descent even in a differentiable setup.
  }
}

@inproceedings{paulus2024advprompter,
  title        = {AdvPrompter: Fast Adaptive Adversarial Prompting for LLMs},
  author       = {Anselm Paulus* and
                  Arman Zharmagambetov* and
                  Chuan Guo and
                  Brandon Amos$^{\dagger}$ and
                  Yuandong Tian$^{\dagger}$},
  year         = {2025},
  codeurl      = {https://github.com/facebookresearch/advprompter},
  url          = {https://arxiv.org/abs/2404.16873},
  _venue       = {ICML},
  selected     = {true},
  abstract     = {
    Large Language Models (LLMs) are vulnerable to jailbreaking attacks that lead to generation of inappropriate or harmful content. Manual red-teaming requires a time-consuming search for adversarial prompts, whereas automatic adversarial prompt generation often leads to semantically meaningless attacks that do not scale well. In this paper, we present a novel method that uses another LLM, called AdvPrompter, to generate human-readable adversarial prompts in seconds. AdvPrompter, which is trained using an alternating optimization algorithm, generates suffixes that veil the input instruction without changing its meaning, such that the TargetLLM is lured to give a harmful response. Experimental results on popular open source TargetLLMs show highly competitive results on the AdvBench and HarmBench datasets, that also transfer to closed-source black-box LLMs. We also show that training on adversarial suffixes generated by AdvPrompter is a promising strategy for improving the robustness of LLMs to jailbreaking attacks.
  }
}


@misc{paulus2025hard,
  title        = {Hard Contacts with Soft Gradients: Refining Differentiable Simulators for Learning and Control},
  author       = {Anselm Paulus* and
                  Andreas René Geist* and
                  Pierre Schumacher and
                  Vít Musil and
                  Georg Martius},
  year         = {2025},
  url          = {https://arxiv.org/abs/2506.14186},
  _venue       = {Under submission},
  selected     = {true},
  abstract     = {
    Contact forces pose a major challenge for gradient-based optimization of robot dynamics as they introduce jumps in the system's velocities. Penalty-based simulators, such as MuJoCo, simplify gradient computation by softening the contact forces. However, realistically simulating hard contacts requires very stiff contact settings, which leads to incorrect gradients when using automatic differentiation. On the other hand, using non-stiff settings strongly increases the sim-to-real gap. We analyze the contact computation of penalty-based simulators to identify the causes of gradient errors. Then, we propose DiffMJX, which combines adaptive integration with MuJoCo XLA, to notably improve gradient quality in the presence of hard contacts. Finally, we address a key limitation of contact gradients: they vanish when objects do not touch. To overcome this, we introduce Contacts From Distance (CFD), a mechanism that enables the simulator to generate informative contact gradients even before objects are in contact. To preserve physical realism, we apply CFD only in the backward pass using a straight-through trick, allowing us to compute useful gradients without modifying the forward simulation.
  }
}



